@model IEnumerable<LibraryManagementSystem.Models.Book>

@{
    ViewData["Title"] = "Browse Books";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* üîπ Background image */
    body {
        background: url('/images/librarybg.jpg') no-repeat center center fixed;
        background-size: cover;
    }

    /* üîπ Blur container */
    .blur-overlay {
        backdrop-filter: blur(6px);
        background: rgba(255, 255, 255, 0.55);
        border-radius: 20px;
        padding: 20px;
        margin-top: 20px;
    }

    /* üîπ Book Card Styling */
    .book-card {
        border-radius: 18px;
        overflow: hidden;
        backdrop-filter: blur(4px);
        background: rgba(255, 255, 255, 0.75);
        transition: transform 0.25s ease, box-shadow 0.25s ease;
        animation: fadeUp 0.7s ease;
    }

    .book-card:hover {
        transform: translateY(-6px) scale(1.02);
        box-shadow: 0px 10px 25px rgba(0, 0, 0, 0.25);
    }

    .book-image {
        height: 260px;
        width: 100%;
        object-fit: cover;
    }

    .book-title {
        font-size: 18px;
        font-weight: 700;
        color: #222;
    }

    .badge-available {
        background: #28a745;
        padding: 5px 10px;
        color: white;
        border-radius: 12px;
        font-size: 12px;
    }

    .badge-unavailable {
        background: #dc3545;
        padding: 5px 10px;
        color: white;
        border-radius: 12px;
        font-size: 12px;
    }

    .details-btn, .add-btn {
        font-size: 14px;
        font-weight: 600;
        color: #0d6efd;
        text-decoration: none;
    }

    .details-btn:hover, .add-btn:hover {
        text-decoration: underline;
    }

    .login-to-add {
        font-size: 13px;
        color: #444;
    }

    @@keyframes fadeUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>

<div class="container blur-overlay">

    <h3 class="fw-bold mb-3">üìö Browse Books</h3>

    <!-- üîç Search Bar -->
    <form asp-action="BrowseBooks" method="get" class="row mb-4">
        <div class="col-md-10">
            <input type="text" name="query" value="@Context.Request.Query["query"]"
                   class="form-control form-control-lg"
                   placeholder="Search by title or author..." />
        </div>
        <div class="col-md-2">
            <button class="btn btn-primary btn-lg w-100">üîç Search</button>
        </div>
    </form>

    <!-- üîπ Category Filters -->
    <div class="mb-4">
        <a asp-action="BrowseBooks" class="btn btn-outline-dark rounded-pill px-4">All</a>
        <a asp-action="BrowseBooks" asp-route-cat="CSE" class="btn btn-outline-dark rounded-pill px-4">CSE</a>
        <a asp-action="BrowseBooks" asp-route-cat="IT" class="btn btn-outline-dark rounded-pill px-4">IT</a>
        <a asp-action="BrowseBooks" asp-route-cat="Mechanical" class="btn btn-outline-dark rounded-pill px-4">Mechanical</a>
        <a asp-action="BrowseBooks" asp-route-cat="Civil" class="btn btn-outline-dark rounded-pill px-4">Civil</a>
        <a asp-action="BrowseBooks" asp-route-cat="Chemical" class="btn btn-outline-dark rounded-pill px-4">Chemical</a>
    </div>

    <!-- üîπ Book Grid -->
    <div class="row g-4">

        @foreach (var book in Model)
        {
            <div class="col-md-4 col-lg-3">

                <div class="card book-card">
                    <img src="@book.ImagePath" class="book-image" alt="@book.Title" />

                    <div class="card-body">
                        <div class="book-title">@book.Title</div>

                        <div class="d-flex justify-content-between mt-2 mb-3">
                            <small class="text-muted">@book.Author</small>
                        </div>

                        @if (book.Quantity > 0)
                        {
                            <span class="badge-available">Available</span>
                        }
                        else
                        {
                            <span class="badge-unavailable">Unavailable</span>
                        }

                        <div class="d-flex justify-content-between mt-3">

                            <a class="details-btn" asp-action="Details" asp-route-id="@book.Id">
                                <i class="bi bi-eye"></i> Details
                            </a>

                            @if (Context.Session.GetString("LoginId") != null)
                            {
                                <a class="add-btn" asp-action="IssueBookForm" asp-route-id="@book.Id">
                                    <i class="bi bi-plus-lg"></i> Add
                                </a>
                            }
                            else
                            {
                                <a class="login-to-add" asp-controller="Account" asp-action="login">
                                    <i class="bi bi-box-arrow-in-right"></i> Login to add
                                </a>

                            }
                        </div>

                    </div>
                </div>

            </div>
        }

    </div>

</div>
