@model List<LibraryManagementSystem.Models.Book>
@using Microsoft.AspNetCore.Http

@{
    ViewData["Title"] = "Search Books";
    var departments = new List<string> { "All", "CSE", "IT", "Mechanical", "Civil", "Chemical" };

    var query = ViewContext.HttpContext.Request.Query;
    var selectedTitle = query["title"].ToString();
    var selectedAuthor = query["author"].ToString();
    var selectedDepartment = query["category"].ToString();
}

<div class="container my-5">
    <h2 class="text-primary mb-4 fw-bold">üîç Search Books in Library</h2>

    <!-- Search Form -->
    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <form method="get" asp-action="Search" asp-controller="Books" class="row g-3">
                <div class="col-md-3">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-book"></i></span>
                        <input type="text" name="title" value="@selectedTitle" class="form-control" placeholder="Book Title" />
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-user"></i></span>
                        <input type="text" name="author" value="@selectedAuthor" class="form-control" placeholder="Author Name" />
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-building-columns"></i></span>
                        <select name="category" class="form-select">
                            <option value="">All Departments</option>
                            @foreach (var dept in departments)
                            {
                                <option value="@dept" selected="@(selectedDepartment == dept ? "selected" : null)">
                                    @dept
                                </option>
                            }
                        </select>
                    </div>
                </div>
                <div class="col-md-3 d-flex gap-2">
                    <button type="submit" class="btn btn-primary flex-fill">üîç Search</button>
                    <a href="/Books/Search" class="btn btn-outline-secondary flex-fill">‚ùå Clear</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Search Results -->
    @if (Model == null || !Model.Any())
    {
        <div class="alert alert-info text-center py-4 fs-5 shadow-sm">
            üîç No books found. Please enter search details above.
        </div>
    }
    else
    {
        <div class="table-responsive shadow-sm">
            <table class="table table-hover align-middle">
                <thead class="table-primary">
                    <tr>
                        <th>#</th>
                        <th>Title</th>
                        <th>Author</th>
                        <th>Department</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.Count; i++)
                    {
                        var book = Model[i];
                        <tr>
                            <td>@(i + 1)</td>
                            <td>@book.Title</td>
                            <td>@book.Author</td>
                            <td>@book.Department</td>
                            <td>
                                @if (book.IsAvailable)
                                {
                                    <span class="badge bg-success">Available</span>
                                }
                                else
                                {
                                    <span class="badge bg-danger">Issued</span>
                                }
                            </td>
                            <td>
                                <a asp-action="Details" asp-controller="Books" asp-route-id="@book.Id" class="btn btn-sm btn-outline-info">
                                    View
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>

@section Styles {
    <style>
        /* Page background */
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e3f2fd 100%);
            min-height: 100vh;
        }

        /* Card shadow and styling */
        .card {
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        /* Table styling */
        table {
            border-radius: 0.5rem;
            overflow: hidden;
        }

        table.table-hover tbody tr:hover {
            background-color: #dbe9f7;
        }

        /* Input group styling */
        .input-group-text {
            background-color: #e9ecef;
        }

        /* Buttons hover */
        .btn-primary:hover {
            background-color: #0b5ed7;
            border-color: #0a58ca;
        }

        .btn-outline-secondary:hover {
            background-color: #6c757d;
            color: white;
        }

        /* Alerts */
        .alert {
            border-radius: 0.5rem;
        }

        /* Responsive tweaks */
        @@media (max-width: 576px) {
            .col-md-3.d-flex.gap-2 {
                flex-direction: column;
            }
        }
    </style>
}

